<section class="mx-auto w-full max-w-7xl px-4 py-8 sm:px-6 lg:px-8">
  <a routerLink="/products" class="mb-6 inline-flex text-sm font-medium text-blue-600 hover:text-blue-700">‚Üê Back to products</a>

  @if (loading$ | async) {
    <div class="grid gap-8 rounded-2xl border border-slate-200 bg-white p-6 lg:grid-cols-2">
      <div class="h-80 animate-pulse rounded-xl bg-slate-200"></div>
      <div class="space-y-4">
        <div class="h-4 w-24 animate-pulse rounded bg-slate-200"></div>
        <div class="h-8 w-3/4 animate-pulse rounded bg-slate-200"></div>
        <div class="h-6 w-28 animate-pulse rounded bg-slate-200"></div>
        <div class="h-20 w-full animate-pulse rounded bg-slate-200"></div>
      </div>
    </div>
  } @else if (error$ | async; as errorMessage) {
    <div class="rounded-md border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700">
      {{ errorMessage }}
    </div>
  } @else if (product$ | async; as product) {
    <article class="grid gap-8 rounded-2xl border border-slate-200 bg-white p-6 shadow-sm lg:grid-cols-2">
      <div class="flex min-h-80 items-center justify-center rounded-xl bg-white p-6">
        <img [src]="product.image" [alt]="product.title" class="max-h-80 w-auto object-contain" />
      </div>

      <div class="flex flex-col">
        <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">{{ product.category | titlecase }}</p>
        <h1 class="mt-2 text-3xl font-semibold tracking-tight text-slate-900">{{ product.title }}</h1>
        <p class="mt-3 text-2xl font-semibold text-slate-900">{{ product.price | currency }}</p>
        <p class="mt-5 text-sm leading-6 text-slate-700">{{ product.description }}</p>

        <div class="mt-6 flex items-center gap-3">
          <p class="text-sm font-medium text-slate-600">In stock: {{ product.quantity }}</p>
        </div>

        <div class="mt-4 flex items-center gap-2">
          <input
            type="number"
            min="1"
            [max]="product.quantity"
            [value]="quantityToAdd"
            (input)="onQuantityInput($event)"
            [disabled]="product.quantity === 0"
            class="w-24 rounded-md border border-slate-300 px-3 py-2 text-sm text-slate-900 disabled:cursor-not-allowed disabled:bg-slate-100"
            aria-label="Quantity to add"
          />
          <button
            type="button"
            (click)="onAddToCart(product.id)"
            [disabled]="product.quantity === 0"
            class="rounded-md bg-slate-900 px-4 py-2 text-sm font-semibold text-white transition hover:bg-slate-700 disabled:cursor-not-allowed disabled:bg-slate-300"
          >
            Add to cart
          </button>
        </div>
      </div>
    </article>
  } @else {
    <div class="rounded-md border border-slate-200 bg-white px-4 py-6 text-sm text-slate-600">
      Product not found.
    </div>
  }
</section>
